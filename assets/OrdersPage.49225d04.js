import{H as g,r as b,b1 as h,S as q,j as i,k as d,d as s,K as r,l as c,N as w,F as y,P as v,R as u}from"./index.71601946.js";import{Q as x}from"./QInput.585ff090.js";import{Q as _}from"./QTd.058bde42.js";import{Q as k}from"./QTable.f9abebba.js";import"./use-key-composition.3c3f930f.js";import"./QSelect.93cc7b2e.js";import"./QDialog.a0f6058c.js";const Q={class:"q-ma-md"},B=c("div",{class:"backH4 text-h4 text-center"},"\u8A02\u55AE\u660E\u7D30",-1),P={class:"q-pl-xs text-left"},I={__name:"OrdersPage",setup(S){const m=g([]),o=b(""),f=[{name:"id",required:!0,label:"\u8A02\u55AE\u7DE8\u865F",align:"center",field:"_id"},{name:"name",required:!0,label:"\u8A02\u8CFC\u4EBA",align:"center"},{name:"date",required:!0,label:"\u8A02\u8CFC\u65E5\u671F",align:"center",field:"date",format:t=>`${new Date(t).toLocaleDateString()}`,sortable:!0},{name:"product",required:!0,label:"\u5546\u54C1",align:"center"},{name:"total",required:!0,label:"\u91D1\u984D",align:"center",field:"totalPrice"}];return(async()=>{var t,l;try{const{data:e}=await h.get("/orders/all");m.push(...e.result.map(a=>(a.totalPrice=a.products.reduce((n,p)=>n+p.p_id.price*p.quantity,0),a)))}catch(e){q.fire({toast:!0,timer:1e3,showConfirmButton:!1,background:"#F5ABA5",icon:"error",color:"black",text:((l=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:l.message)||"\u8A02\u55AE\u932F\u8AA4\uFF01"})}})(),(t,l)=>(i(),d("div",Q,[B,s(k,{class:"order-table q-ma-md",columns:f,rows:m,"row-key":"_id",filter:o.value,loading:t.loading},{"top-right":r(()=>[s(x,{class:"q-mr-md",borderless:"",dense:"",debounce:"300",modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=e=>o.value=e),placeholder:"Search"},{append:r(()=>[s(w,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-product":r(e=>[s(_,null,{default:r(()=>[(i(!0),d(y,null,v(e.row.products,a=>{var n;return i(),d("ul",P,[c("li",null,u(a==null?void 0:a.quantity)+" x \xA0 \xA0 "+u((n=a.p_id)==null?void 0:n.name),1)])}),256))]),_:2},1024)]),"body-cell-name":r(e=>[s(_,null,{default:r(()=>{var a;return[c("span",null,u((a=e.row.u_id)==null?void 0:a.name),1)]}),_:2},1024)]),_:1},8,["rows","filter","loading"])]))}};export{I as default};
