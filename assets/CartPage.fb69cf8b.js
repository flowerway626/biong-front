import{af as B,r as f,H as A,b1 as $,S,c as z,j as n,k as i,l as t,J as O,q as k,F as v,P as x,d as l,R as c,A as P,O as r,K as d,L as j,ay as D,aC as F,Q as I}from"./index.71601946.js";import{Q as L}from"./QInput.585ff090.js";import{Q as N,a as h}from"./QCard.ad0352ee.js";import{Q as U}from"./QDialog.a0f6058c.js";import"./use-key-composition.3c3f930f.js";const H={class:"q-pa-md",id:"cart"},R=t("div",{class:"text-center text-h4 backH4"},"\u8CFC\u7269\u8ECA",-1),T={class:"row justify-center"},E={class:"col-12 col-md-6 left"},J={key:1,class:"text-center text-grey"},K={class:"col-auto"},G={class:"col-7 q-ml-md"},M={class:"text-h6"},W={class:"text-body1 q-mb-md text-grey"},X={class:"text-body1"},Y=t("span",null,"\u6578\u91CF\uFF1A",-1),Z={class:"col-auto column items-end q-ml-auto"},ee={class:"col text-h6"},te={class:"col"},se={class:"right col-12 col-md-4 text-center q-px-xl"},ae={class:"card flex items-end"},oe={class:"text-h5 text-weight-bold"},le=t("div",{class:"text-center text-subtitle1"},"\u8A02\u55AE\u78BA\u8A8D",-1),ne={style:{"padding-left":"20px"}},me={__name:"CartPage",setup(ie){const C=j(),y=D(),w=B(),u=f(!1),{editCart:q,checkOut:b}=w,_=f(!1),s=A([]);(async()=>{var o,a;try{u.value=!0;const{data:e}=await $.get("/users/cart");s.push(...e.result),u.value=!1}catch(e){S.fire({toast:!0,timer:1e3,showConfirmButton:!1,background:"#F5ABA5",icon:"error",color:"black",text:((a=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:a.message)||"\u8CFC\u7269\u8ECA\u932F\u8AA4\uFF01"})}})();const m=async(o,a)=>{await q({_id:s[o].p_id._id,quantity:a}),s[o].quantity+=a,s[o].quantity<=0?(s.splice(o,1),y.notify({type:"positive",color:"pink",message:"\u6210\u529F\u522A\u9664\u5546\u54C1",position:"top"})):y.notify({type:"positive",color:"warning",message:"\u4FEE\u6539\u6578\u91CF\u5B8C\u6210",position:"top"})},Q=z(()=>s.reduce((o,a)=>o+a.p_id.price*a.quantity,0)),V=async()=>{u.value=!0,await b(),s.splice(0,s.length),C.push("/setting/order"),u.value=!1};return(o,a)=>(n(),i(v,null,[t("div",H,[R,t("div",T,[t("div",E,[(s==null?void 0:s.length)===0?(n(),O(F,{key:0,class:"q-my-md"})):k("",!0),(s==null?void 0:s.length)===0?(n(),i("div",J,"\u8CFC\u7269\u8ECA\u5167\u6C92\u6709\u5546\u54C1~")):k("",!0),(n(!0),i(v,null,x(s,(e,p)=>(n(),i("div",{class:"cartInfo row justify-center",key:e._id},[t("div",K,[l(I,{class:"text-center",src:e.p_id.image,style:{width:"100px"}},null,8,["src"])]),t("div",G,[t("div",M,c(e.p_id.name),1),t("div",W,"$ "+c(e.p_id.price),1),t("div",X,[Y,l(r,{icon:"mdi-minus",round:"",outline:"",unelevated:"",size:"8px",color:"warning",onClick:g=>m(p,-1)},null,8,["onClick"]),t("span",null,"\xA0\xA0"+c(e.quantity)+" \xA0\xA0",1),l(r,{icon:"mdi-plus",round:"",outline:"",unelevated:"",size:"8px",color:"warning",onClick:g=>m(p,1)},null,8,["onClick"])])]),t("div",Z,[t("div",ee,"$ "+c(e.p_id.price*e.quantity),1),t("div",te,[l(r,{icon:"delete",round:"",unelevated:"",size:"10px",color:"pink",onClick:g=>m(p,e.quantity*-1)},null,8,["onClick"])])])]))),128))]),t("div",se,[t("div",ae,[l(L,{modelValue:o.card,"onUpdate:modelValue":a[0]||(a[0]=e=>o.card=e),borderless:"",color:"warning",label:"Card",mask:"#### #### #### ####","fill-mask":"_",style:{width:"50%"}},null,8,["modelValue"])]),t("div",oe,"TOTAL\uFF1A "+c(P(Q))+" \u5143",1),l(r,{class:"q-mt-md full-width q-mx-md",icon:"money",label:"\u7D50\u5E33 go",rounded:"",push:"",color:"warning","text-color":"black",onClick:a[1]||(a[1]=e=>_.value=!0)})])])]),l(U,{modelValue:_.value,"onUpdate:modelValue":a[2]||(a[2]=e=>_.value=e)},{default:d(()=>[l(N,null,{default:d(()=>[l(h,{style:{background:"linear-gradient(135deg, #53C2BA 0%, #C0538A 100%)"}},{default:d(()=>[le]),_:1}),l(h,null,{default:d(()=>[t("ul",ne,[(n(!0),i(v,null,x(s,e=>(n(),i("li",{key:e._id},[t("span",null,c(e.p_id.name+" x "+e.quantity),1)]))),128))])]),_:1}),l(h,{class:"text-center"},{default:d(()=>[l(r,{label:"\u9001\u51FA\u8A02\u55AE",push:"",size:"sm",color:"secondary",onClick:V})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{me as default};
